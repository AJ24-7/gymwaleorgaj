<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gym Details - Gym-Wale</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="gymdetails.css">
    <link rel="stylesheet" href="gymdetails-offers.css">
    <link rel="stylesheet" href="gymdetails-chat.css">
    <link rel="stylesheet" href="floating-gym-chat.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <!-- IMPORTANT: Load centralized config FIRST -->
    <script src="config.js"></script>
    <script defer src="gymdetails.js"></script>
    <script defer src="gymdetails-offers.js"></script>
    <script defer src="coupon-integration.js"></script>
    <script defer src="gymdetails-chat.js"></script>
    <script defer src="floating-gym-chat.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-spinner">
            <i class="fas fa-dumbbell fa-spin"></i>
            <p>Loading gym details...</p>
        </div>
    </div>

    <!-- Navbar -->
    <header>
        <nav class="navbar">
              <a href="index.html" style="display:flex;align-items:center;gap:12px;text-decoration:none;">
              <img class="logo" src="public/Gym-Wale.png" alt="Gym-Wale Logo">
              <h3 class="brand-title">Gym<span>-Wale</span></h3>
            </a>
            <ul class="nav-links">
                <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="#" class="nav-item"><i class="fas fa-info-circle"></i> About</a></li>
                <li class="dropdown">
                    <a href="#" class="nav-item"><i class="fas fa-concierge-bell"></i> Services ‚¨á</a>
                    <ul class="dropdown-menu">
                        <li><a href="personaltraining.html"><i class="fas fa-user-tie"></i> Personal Training</a></li>
                        <li><a href="membership-plans.html"><i class="fas fa-id-card"></i> Membership Plans</a></li>
                        <li><a href="dietplans.html"><i class="fas fa-apple-alt"></i> Diet Plans</a></li>
                    </ul>
                </li>
                <li><a href="contact.html" class="nav-item"><i class="fas fa-envelope"></i> Contact</a></li>
                <!-- User Profile -->
                <li class="dropdown user-profile" id="user-profile-nav" style="display: none;">
                    <a href="/public/userprofile.html" class="nav-item">
                        <img id="profile-icon-img" src="/uploads/profile-pics/default.png" alt="User" class="user-icon" />
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="edit-profile.html"><i class="fas fa-user-edit"></i> Edit Profile</a></li>
                        <li><a href="settings.html"><i class="fas fa-cog"></i> Settings</a></li>
                        <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                    </ul>
                </li>
                <!-- Login/Signup -->
                <li class="nav-item" id="login-signup-nav" style="display: none;">
                    <a href="/public/login.html"><i class="fas fa-sign-in-alt"></i> Login / Signup</a>
                </li>
            </ul>
            <div class="menu-toggle">&#9776;</div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="gym-details-main" id="gym-content" style="display: none;">
        <!-- Hero Section with Gym Logo and Basic Info -->
        <section class="gym-hero">
            <div class="gym-hero-content">
                <div class="gym-basic-info">
                    <img id="gym-logo" src="" alt="Gym Logo" class="gym-logo">
                    <div class="gym-info-text">
                        <h1 id="gym-name">Gym Name</h1>
                        <div class="gym-meta">
                            <p><i class="fas fa-map-marker-alt"></i> <span id="gym-address">Address</span></p>
                            <p><i class="fas fa-clock"></i> <span id="gym-hours">Hours</span></p>
                            <p><i class="fas fa-users"></i> <span id="gym-members">Members</span> active members</p>
                            <div class="gym-status" id="gym-status">
                                <span class="status-badge approved">Verified</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="quick-actions">
                    <!-- Rating Display -->
                    <div class="gym-rating-display" id="hero-rating">
                        <div class="rating-summary">
                            <div class="rating-stars" id="hero-rating-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="rating-info">
                                <span class="rating-value" id="hero-rating-value">0.0</span>
                                <span class="rating-count" id="hero-rating-count">(0 reviews)</span>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn-primary trial-booking-btn" id="trial-booking-btn">
                        <i class="fas fa-calendar-plus"></i> Book Trial
                    </button>
                    <button class="btn-secondary offers-btn" id="offers-btn">
                        <i class="fas fa-gift"></i> View Offers
                    </button>
                    <button class="btn-report" id="report-issue-btn" onclick="openReportIssueModal()">
                        <i class="fas fa-flag"></i> Report Issue
                    </button>
                   
                </div>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <section class="gym-nav-tabs">
            <div class="tab-container">
                <button class="tab-btn active" onclick="switchTab('photos')">
                    <i class="fas fa-camera"></i> Photos
                </button>
                <button class="tab-btn" onclick="switchTab('membership')">
                    <i class="fas fa-credit-card"></i> Membership
                </button>
                <button class="tab-btn" onclick="switchTab('activities')">
                    <i class="fas fa-bolt"></i> Activities
                </button>
                <button class="tab-btn" onclick="switchTab('location')">
                    <i class="fas fa-map"></i> Location
                </button>
                <button class="tab-btn" onclick="switchTab('rush-hours')">
                    <i class="fas fa-chart-line"></i> Rush Hours
                </button>
                <button class="tab-btn" onclick="switchTab('reviews')">
                    <i class="fas fa-star"></i> Reviews
                </button>
            </div>
        </section>

        <!-- Tab Content -->
        <div class="tab-content-container">
            <!-- Photos Tab -->
            <div id="photos-tab" class="tab-content active">
                <div class="photos-section">
                    <h2><i class="fas fa-camera"></i> Gym Gallery</h2>
                    <div class="photos-grid" id="photos-grid">
                        <!-- Photos will be dynamically loaded -->
                    </div>
                </div>
                
                <!-- Equipment Gallery Section -->
                <div class="equipment-gallery-section">
                    <h2><i class="fas fa-dumbbell"></i> Equipment Gallery</h2>
                    <div class="equipment-filter-tabs">
                        <button class="filter-btn active" data-category="all">
                            <i class="fas fa-th"></i> All Equipment
                        </button>
                        <button class="filter-btn" data-category="cardio">
                            <i class="fas fa-heartbeat"></i> Cardio
                        </button>
                        <button class="filter-btn" data-category="strength">
                            <i class="fas fa-dumbbell"></i> Strength
                        </button>
                        <button class="filter-btn" data-category="functional">
                            <i class="fas fa-running"></i> Functional
                        </button>
                        <button class="filter-btn" data-category="other">
                            <i class="fas fa-plus"></i> Other
                        </button>
                    </div>
                    <div class="equipment-gallery-grid" id="equipment-gallery-grid">
                        <!-- Equipment will be dynamically loaded -->
                        <div class="equipment-loading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Loading equipment...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Membership Tab -->
            <div id="membership-tab" class="tab-content">
                <div class="membership-section">
                    <h2><i class="fas fa-credit-card"></i> Membership Plans</h2>
                    <div class="membership-grid" id="membership-grid">
                        <!-- Membership plans will be dynamically loaded -->
                    </div>
                </div>
            </div>

            <!-- Activities Tab -->
            <div id="activities-tab" class="tab-content">
                <div class="activities-section">
                    <h2><i class="fas fa-bolt"></i> Activities Offered</h2>
                    <div class="activities-grid" id="activities-grid">
                        <!-- Activities will be dynamically loaded -->
                    </div>
                    <div class="equipment-section">
                        <h3><i class="fas fa-dumbbell"></i> Equipment Available</h3>
                        <div class="equipment-list" id="equipment-list">
                            <!-- Equipment will be dynamically loaded -->
                        </div>
                        <div class="equipment-gallery-link">
                            <button class="btn-primary" onclick="switchTab('photos')">
                                <i class="fas fa-images"></i> View Full Equipment Gallery
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Location Tab -->
            <div id="location-tab" class="tab-content">
                <div class="location-section">
                    <h2><i class="fas fa-map"></i> Location & Contact</h2>
                    <div class="location-content">
                        <div class="location-info">
                            <div class="info-card">
                                <h3><i class="fas fa-map-marker-alt"></i> Address</h3>
                                <p id="full-address">Full address will be loaded here</p>
                            </div>
                            <div class="info-card">
                                <h3><i class="fas fa-phone"></i> Contact Information</h3>
                                <p><i class="fas fa-phone"></i> <span id="contact-phone">Phone</span></p>
                                <p><i class="fas fa-envelope"></i> <span id="contact-email">Email</span></p>
                                <p><i class="fas fa-user-tie"></i> <span id="contact-person">Contact Person</span></p>
                            </div>
                        </div>
                        <div class="map-container">
                            <div id="gym-map" class="gym-map">
                                <p>Map will be loaded here</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rush Hours Tab -->
            <div id="rush-hours-tab" class="tab-content">
                <div class="rush-hours-section">
                    <h2><i class="fas fa-chart-line"></i> Rush Hours & Best Times</h2>
                    <div class="rush-hours-content">
                        <!-- Loading state -->
                        <div id="rush-hours-loading" class="loading-state">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Analyzing attendance patterns...</p>
                        </div>
                        
                        <!-- Hours chart will be populated dynamically -->
                        <div id="hours-chart" class="hours-chart" style="display: none;">
                            <!-- Dynamic content will be inserted here -->
                        </div>
                        
                        <!-- Period analysis -->
                        <div id="period-analysis" class="period-analysis" style="display: none;">
                            <h3><i class="fas fa-clock"></i> Best Times to Visit</h3>
                            <div id="time-recommendations" class="time-recommendations">
                                <!-- Dynamic period recommendations will be inserted here -->
                            </div>
                        </div>
                        
                        <!-- Statistics summary -->
                        <div id="rush-statistics" class="rush-statistics" style="display: none;">
                            <h3><i class="fas fa-chart-bar"></i> Attendance Statistics</h3>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <i class="fas fa-users"></i>
                                    <span class="stat-value" id="avg-daily-attendance">-</span>
                                    <span class="stat-label">Avg Daily Attendance</span>
                                </div>
                                <div class="stat-card">
                                    <i class="fas fa-clock"></i>
                                    <span class="stat-value" id="peak-hour-display">-</span>
                                    <span class="stat-label">Peak Hour</span>
                                </div>
                                <div class="stat-card">
                                    <i class="fas fa-leaf"></i>
                                    <span class="stat-value" id="least-busy-hour-display">-</span>
                                    <span class="stat-label">Least Busy</span>
                                </div>
                                <div class="stat-card">
                                    <i class="fas fa-calendar"></i>
                                    <span class="stat-value">7 Days</span>
                                    <span class="stat-label">Analysis Period</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Default message when no data -->
                        <div id="rush-hours-no-data" class="no-data-message" style="display: none;">
                            <i class="fas fa-info-circle"></i>
                            <h3>No Attendance Data Available</h3>
                            <p>Rush hour analysis will be available once attendance data is collected for this gym.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reviews Tab -->
            <div id="reviews-tab" class="tab-content">
                <div class="reviews-section">
                    <div class="reviews-header">
                        <h2><i class="fas fa-star"></i> Reviews & Ratings</h2>
                        <button class="btn-primary write-review-btn" id="write-review-btn">
                            <i class="fas fa-edit"></i> Write a Review
                        </button>
                    </div>

                    <!-- Rating Overview -->
                    <div class="rating-overview">
                        <div class="overall-rating">
                            <div class="rating-large">
                                <span class="rating-number" id="main-rating-value">0.0</span>
                                <div class="rating-stars-large" id="main-rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </div>
                                <p class="rating-description" id="main-rating-description">No reviews yet</p>
                            </div>
                        </div>
                        <div class="rating-breakdown">
                            <div class="rating-bar" data-rating="5">
                                <span class="star-label">5 <i class="fas fa-star"></i></span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 0%"></div>
                                </div>
                                <span class="bar-count">0</span>
                            </div>
                            <div class="rating-bar" data-rating="4">
                                <span class="star-label">4 <i class="fas fa-star"></i></span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 0%"></div>
                                </div>
                                <span class="bar-count">0</span>
                            </div>
                            <div class="rating-bar" data-rating="3">
                                <span class="star-label">3 <i class="fas fa-star"></i></span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 0%"></div>
                                </div>
                                <span class="bar-count">0</span>
                            </div>
                            <div class="rating-bar" data-rating="2">
                                <span class="star-label">2 <i class="fas fa-star"></i></span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 0%"></div>
                                </div>
                                <span class="bar-count">0</span>
                            </div>
                            <div class="rating-bar" data-rating="1">
                                <span class="star-label">1 <i class="fas fa-star"></i></span>
                                <div class="bar-container">
                                    <div class="bar-fill" style="width: 0%"></div>
                                </div>
                                <span class="bar-count">0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Reviews List -->
                    <div class="reviews-list" id="reviews-list">
                        <div class="reviews-loading" id="reviews-loading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Loading reviews...</p>
                        </div>
                        <div class="no-reviews" id="no-reviews" style="display: none;">
                            <i class="fas fa-star-half-alt"></i>
                            <h3>No Reviews Yet</h3>
                            <p>Be the first to share your experience at this gym!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gym Description -->
        <section class="gym-description">
            <h2><i class="fas fa-info-circle"></i> About This Gym</h2>
            <p id="gym-description-text">Gym description will be loaded here...</p>
        </section>
    </main>

    <!-- Write Review Modal -->
    <div id="write-review-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-star"></i> Write a Review</h3>
                <span class="close" id="close-review-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="review-form">
                    <div class="form-group">
                        <label for="review-rating">Rating</label>
                        <div class="star-rating" id="star-rating">
                            <i class="fas fa-star" data-rating="1"></i>
                            <i class="fas fa-star" data-rating="2"></i>
                            <i class="fas fa-star" data-rating="3"></i>
                            <i class="fas fa-star" data-rating="4"></i>
                            <i class="fas fa-star" data-rating="5"></i>
                        </div>
                        <input type="hidden" id="rating-value" name="rating" required>
                    </div>
                    <div class="form-group">
                        <label for="review-comment">Your Review</label>
                        <textarea id="review-comment" name="comment" rows="5" placeholder="Share your experience at this gym..." required></textarea>
                    </div>
                    <div class="login-notice" id="login-notice" style="display: none;">
                        <i class="fas fa-info-circle"></i>
                        <p>Please <a href="/public/login.html">login</a> to submit a review.</p>
                    </div>
                    <div class="user-info" id="user-info" style="display: none;">
                        <i class="fas fa-user"></i>
                        <p>Posting as: <span id="review-user-name"></span></p>
                    </div>
                    <button type="submit" class="btn-primary" id="submit-review-btn">Submit Review</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Trial Booking Modal -->
    <div id="trial-booking-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-plus"></i> Book Your Trial</h3>
                <span class="close" id="close-trial-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="trial-booking-form">
                    <!-- Personal Information -->
                    <div class="form-section">
                        <h4><i class="fas fa-user"></i> Personal Information</h4>
                        <div class="form-group">
                            <label for="trial-name">Full Name *</label>
                            <input type="text" id="trial-name" name="name" required placeholder="Enter your full name">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="trial-phone">Phone Number *</label>
                                <input type="tel" id="trial-phone" name="phone" required placeholder="Your phone number">
                            </div>
                            <div class="form-group">
                                <label for="trial-email">Email Address *</label>
                                <input type="email" id="trial-email" name="email" required placeholder="your.email@example.com">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="trial-dob">Date of Birth *</label>
                            <input type="date" id="trial-dob" name="dob" required>
                        </div>
                    </div>

                    <!-- Session Preferences -->
                    <div class="form-section">
                        <h4><i class="fas fa-calendar"></i> Session Preferences</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="trial-date">Preferred Date *</label>
                                <input type="date" id="trial-date" name="date" required>
                            </div>
                            <div class="form-group">
                                <label for="trial-time">Preferred Time *</label>
                                <select id="trial-time" name="time" required>
                                    <option value="">Select time</option>
                                    <option value="06:00">6:00 AM</option>
                                    <option value="07:00">7:00 AM</option>
                                    <option value="08:00">8:00 AM</option>
                                    <option value="09:00">9:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="12:00">12:00 PM</option>
                                    <option value="17:00">5:00 PM</option>
                                    <option value="18:00">6:00 PM</option>
                                    <option value="19:00">7:00 PM</option>
                                    <option value="20:00">8:00 PM</option>
                                    <option value="21:00">9:00 PM</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Fitness Information -->
                    <div class="form-section">
                        <h4><i class="fas fa-dumbbell"></i> Fitness Information</h4>
                        <div class="form-group">
                            <label for="trial-fitness-goal">Primary Fitness Goal *</label>
                            <select id="trial-fitness-goal" name="fitnessGoal" required>
                                <option value="">Select your primary goal</option>
                                <option value="Weight Loss">Weight Loss</option>
                                <option value="Muscle Gain">Muscle Gain</option>
                                <option value="General Fitness">General Fitness</option>
                                <option value="Strength Training">Strength Training</option>
                                <option value="Cardio Fitness">Cardio Fitness</option>
                                <option value="Flexibility">Flexibility & Mobility</option>
                                <option value="Sports Training">Sports Training</option>
                                <option value="Rehabilitation">Rehabilitation</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="trial-activity">Interested Activity</label>
                            <select id="trial-activity" name="activity">
                                <option value="">Select activity (optional)</option>
                                <!-- Activities will be populated dynamically -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="trial-experience">Fitness Experience</label>
                            <select id="trial-experience" name="experience">
                                <option value="">Select your experience level</option>
                                <option value="Beginner">Beginner (0-6 months)</option>
                                <option value="Intermediate">Intermediate (6 months - 2 years)</option>
                                <option value="Advanced">Advanced (2+ years)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Additional Information -->
                    <div class="form-section">
                        <h4><i class="fas fa-info-circle"></i> Additional Information</h4>
                        <div class="form-group">
                            <label for="trial-message">Special Requirements or Messages</label>
                            <textarea id="trial-message" name="message" rows="3" placeholder="Any specific requirements, health concerns, or questions? (Optional)"></textarea>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer; margin-bottom: 15px;">
                                <input type="checkbox" id="trial-terms" name="terms" required style="margin-top: 3px; width: 18px; height: 18px; accent-color: #4CAF50;">
                                <span style="font-size: 14px; line-height: 1.4;">I agree to the <a href="#" style="color: #4CAF50; text-decoration: underline;">terms and conditions</a> and <a href="#" style="color: #4CAF50; text-decoration: underline;">privacy policy</a> *</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer; margin-bottom: 15px;">
                                <input type="checkbox" id="trial-whatsapp" name="whatsappConsent" style="margin-top: 3px; width: 18px; height: 18px; accent-color: #4CAF50;">
                                <span style="font-size: 14px; line-height: 1.4;">I consent to receive updates and notifications via WhatsApp</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-secondary" id="cancel-trial-booking">Cancel</button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-paper-plane"></i> Book Trial Session
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Photo Modal -->
    <div id="photo-modal" class="modal photo-modal">
        <div class="modal-content photo-modal-content">
            <span class="close photo-modal-close">&times;</span>
            <img id="modal-photo" src="" alt="Gym Photo">
            <div class="photo-info">
                <h3 id="photo-title">Photo Title</h3>
                <p id="photo-description">Photo description</p>
            </div>
            <div class="photo-navigation">
                <button id="prev-photo" class="nav-btn"><i class="fas fa-chevron-left"></i></button>
                <button id="next-photo" class="nav-btn"><i class="fas fa-chevron-right"></i></button>
            </div>
        </div>
    </div>

    <!-- Equipment Detail Modal -->
    <div id="equipment-detail-modal" class="modal equipment-modal">
        <div class="modal-content equipment-modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-dumbbell"></i> Equipment Details</h3>
                <span class="close" id="close-equipment-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="equipment-detail-content">
                    <div class="equipment-image-section">
                        <div class="equipment-main-image">
                            <img id="equipment-modal-image" src="" alt="Equipment Image">
                        </div>
                        <div class="equipment-image-thumbnails" id="equipment-thumbnails">
                            <!-- Thumbnails will be populated dynamically -->
                        </div>
                    </div>
                    <div class="equipment-info-section">
                        <div class="equipment-basic-info">
                            <h2 id="equipment-modal-name">Equipment Name</h2>
                            <div class="equipment-meta">
                                <span class="equipment-brand" id="equipment-modal-brand">Brand</span>
                                <span class="equipment-model" id="equipment-modal-model">Model</span>
                            </div>
                            <div class="equipment-category-badge" id="equipment-modal-category">
                                <i class="fas fa-tag"></i>
                                <span>Category</span>
                            </div>
                        </div>
                        
                        <div class="equipment-stats">
                            <div class="stat-item">
                                <i class="fas fa-boxes"></i>
                                <span class="stat-label">Quantity</span>
                                <span class="stat-value" id="equipment-modal-quantity">1</span>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-circle"></i>
                                <span class="stat-label">Status</span>
                                <span class="stat-value status-badge" id="equipment-modal-status">Available</span>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span class="stat-label">Location</span>
                                <span class="stat-value" id="equipment-modal-location">Main Floor</span>
                            </div>
                        </div>

                        <div class="equipment-description">
                            <h4><i class="fas fa-info-circle"></i> Description</h4>
                            <p id="equipment-modal-description">Equipment description will be shown here...</p>
                        </div>

                        <div class="equipment-specifications" id="equipment-specifications-section">
                            <h4><i class="fas fa-cogs"></i> Specifications</h4>
                            <div id="equipment-modal-specifications">
                                <!-- Specifications will be populated dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal">
        <div class="modal-content success-modal-content">
            <div class="modal-header success-header">
                <h3><i class="fas fa-check-circle"></i> Success!</h3>
            </div>
            <div class="modal-body">
                <p id="success-message">Your request has been submitted successfully!</p>
                <button id="success-ok-btn" class="btn-primary">OK</button>
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div id="error-modal" class="modal">
        <div class="modal-content error-modal-content">
            <div class="modal-header error-header">
                <h3><i class="fas fa-exclamation-triangle"></i> Error</h3>
            </div>
            <div class="modal-body">
                <p id="error-message">Something went wrong. Please try again.</p>
                <button id="error-ok-btn" class="btn-primary">OK</button>
            </div>
        </div>
    </div>

    <!-- Coupon Selection Modal -->
    <div id="coupon-selection-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-ticket-alt"></i> Apply Coupon</h3>
                <span class="close" id="close-coupon-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="purchase-summary" id="purchase-summary">
                    <h4>Purchase Summary</h4>
                    <div class="summary-item">
                        <span>Plan:</span>
                        <span id="summary-plan-name">-</span>
                    </div>
                    <div class="summary-item">
                        <span>Duration:</span>
                        <span id="summary-duration">-</span>
                    </div>
                    <div class="summary-item">
                        <span>Original Price:</span>
                        <span id="summary-original-price">‚Çπ0</span>
                    </div>
                    <div class="summary-item discount-applied" id="plan-discount" style="display: none;">
                        <span>Plan Discount:</span>
                        <span id="summary-plan-discount">-‚Çπ0</span>
                    </div>
                    <div class="summary-item coupon-applied" id="coupon-discount" style="display: none;">
                        <span>Coupon Discount:</span>
                        <span id="summary-coupon-discount">-‚Çπ0</span>
                    </div>
                    <div class="summary-item total">
                        <span><strong>Final Price:</strong></span>
                        <span id="summary-final-price"><strong>‚Çπ0</strong></span>
                    </div>
                </div>

                <div class="coupon-selection">
                    <h4>Available Coupons</h4>
                    <div class="available-coupons" id="available-coupons">
                        <div class="no-coupons-message">
                            <i class="fas fa-ticket-alt"></i>
                            <p>No coupons available for this gym.</p>
                        </div>
                    </div>
                    
                    <div class="manual-coupon-entry">
                        <h4>Enter Coupon Code</h4>
                        <div class="coupon-input-group">
                            <input type="text" id="manual-coupon-code" placeholder="Enter coupon code" maxlength="20">
                            <button id="apply-manual-coupon" class="btn-secondary">Apply</button>
                        </div>
                        <div class="coupon-validation-message" id="coupon-validation-message" style="display: none;"></div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button id="proceed-without-coupon" class="btn-secondary">Proceed Without Coupon</button>
                    <button id="proceed-with-coupon" class="btn-primary" style="display: none;">Proceed to Payment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Offers Modal -->
    <div id="offers-modal" class="modal">
        <div class="modal-content offers-modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-gift"></i> Special Offers & Deals</h3>
                <span class="close" id="close-offers-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="offers-container">
                    <!-- Offers Loading State -->
                    <div class="offers-loading" id="modal-offers-loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading exclusive offers...</p>
                    </div>
                    
                    <!-- Active Offers Grid -->
                    <div class="modal-offers-grid" id="modal-offers-grid" style="display: none;">
                        <!-- Offers will be loaded here -->
                    </div>
                    
                    <!-- No Offers State -->
                    <div class="no-offers-state" id="modal-no-offers" style="display: none;">
                        <i class="fas fa-gift"></i>
                        <h4>No Active Offers</h4>
                        <p>Check back later for exciting deals and promotions!</p>
                        <button class="btn-primary" onclick="location.href='membership-plans.html'">
                            <i class="fas fa-shopping-cart"></i> Browse Memberships
                        </button>
                    </div>
                    
                    <!-- My Claimed Offers Section -->
                    <div class="my-claimed-offers" id="my-claimed-offers" style="display: none;">
                        <div class="section-header">
                            <h4><i class="fas fa-ticket-alt"></i> My Claimed Offers</h4>
                            <span class="claimed-count" id="claimed-count">0 claimed</span>
                        </div>
                        <div class="claimed-offers-list" id="claimed-offers-list">
                            <!-- Claimed offers will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button class="btn-secondary" id="refresh-offers-btn">
                        <i class="fas fa-sync-alt"></i> Refresh Offers
                    </button>
                    <button class="btn-primary" onclick="location.href='membership-plans.html'">
                        <i class="fas fa-shopping-cart"></i> Browse Plans
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button id="back-to-top" class="back-to-top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Chat Modal -->
    <div id="chat-modal" class="modal">
        <div class="chat-modal-content">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-header-info">
                    <img id="chat-gym-logo" src="" alt="Gym" class="gym-avatar">
                    <div class="chat-gym-details">
                        <h4 id="chat-gym-name">Gym Name</h4>
                        <div class="chat-gym-status">
                            <span class="status-dot"></span>
                            <span>Online</span>
                        </div>
                    </div>
                </div>
                <button class="close-chat-btn" aria-label="Close Chat">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- Chat Messages -->
            <div class="chat-messages-container" id="chat-messages">
                <!-- Messages will be populated dynamically -->
                <div class="empty-chat-state">
                    <i class="fas fa-comments empty-chat-icon"></i>
                    <h3>Start a Conversation</h3>
                    <p>Send a message to connect with this gym</p>
                </div>
            </div>

            <!-- Typing Indicator -->
            <div class="typing-indicator" id="typing-indicator">
                <div class="typing-dots">
                    <span class="typing-dot"></span>
                    <span class="typing-dot"></span>
                    <span class="typing-dot"></span>
                </div>
            </div>

            <!-- Quick Messages -->
            <div class="quick-messages">
                <div class="quick-messages-title">Quick Messages</div>
                <div class="quick-messages-list">
                    <button class="quick-message-btn">Hi! I'd like to know more about your gym</button>
                    <button class="quick-message-btn">What are your membership plans?</button>
                    <button class="quick-message-btn">Are you currently open?</button>
                    <button class="quick-message-btn">Do you have personal training available?</button>
                    <button class="quick-message-btn">Can I book a trial session?</button>
                </div>
            </div>

            <!-- Chat Input -->
            <div class="chat-input-container">
                <button class="attach-btn" aria-label="Attach File" title="Attach File">
                    <i class="fas fa-paperclip"></i>
                </button>
                <textarea 
                    class="chat-input" 
                    placeholder="Type your message..."
                    rows="1"
                    maxlength="1000"
                ></textarea>
                <button class="send-btn" aria-label="Send Message" title="Send">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Report Issue Modal -->
    <div id="report-issue-modal" class="modal">
        <div class="modal-content report-modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-flag"></i> Report an Issue</h3>
                <span class="close" id="close-report-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="report-issue-form">
                    <div class="form-group">
                        <label for="issue-category">
                            <i class="fas fa-list"></i> Issue Category *
                        </label>
                        <select id="issue-category" name="category" required>
                            <option value="">Select a category...</option>
                            <option value="equipment">üèãÔ∏è Equipment Issues</option>
                            <option value="cleanliness">üßπ Cleanliness & Hygiene</option>
                            <option value="staff">üë• Staff Behavior</option>
                            <option value="safety">üõ°Ô∏è Safety Concerns</option>
                            <option value="billing">üí≥ Billing & Payment</option>
                            <option value="facilities">üè¢ Facilities & Amenities</option>
                            <option value="timing">‚è∞ Timing & Schedule</option>
                            <option value="other">üìù Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="issue-priority">
                            <i class="fas fa-exclamation-circle"></i> Priority Level *
                        </label>
                        <select id="issue-priority" name="priority" required>
                            <option value="low">Low - General feedback</option>
                            <option value="normal" selected>Normal - Standard issue</option>
                            <option value="high">High - Needs attention</option>
                            <option value="urgent">Urgent - Immediate action required</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="issue-subject">
                            <i class="fas fa-heading"></i> Subject *
                        </label>
                        <input 
                            type="text" 
                            id="issue-subject" 
                            name="subject" 
                            placeholder="Brief summary of the issue"
                            maxlength="100"
                            required
                        >
                        <small class="char-count"><span id="subject-count">0</span>/100</small>
                    </div>

                    <div class="form-group">
                        <label for="issue-description">
                            <i class="fas fa-align-left"></i> Description *
                        </label>
                        <textarea 
                            id="issue-description" 
                            name="description" 
                            rows="5"
                            placeholder="Please provide detailed information about the issue..."
                            maxlength="1000"
                            required
                        ></textarea>
                        <small class="char-count"><span id="description-count">0</span>/1000</small>
                    </div>

                    <div class="form-group">
                        <label for="issue-contact">
                            <i class="fas fa-phone"></i> Contact Number (Optional)
                        </label>
                        <input 
                            type="tel" 
                            id="issue-contact" 
                            name="contactNumber" 
                            placeholder="Your contact number for follow-up"
                        >
                    </div>

                    <div class="form-group">
                        <label for="issue-email">
                            <i class="fas fa-envelope"></i> Email Address (Optional)
                        </label>
                        <input 
                            type="email" 
                            id="issue-email" 
                            name="email" 
                            placeholder="Your email for updates"
                        >
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeReportModal()">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-paper-plane"></i> Submit Report
                        </button>
                    </div>
                </form>

                <div class="report-info">
                    <i class="fas fa-info-circle"></i>
                    <p>Your report will be sent to the gym management. You'll receive a ticket ID for tracking.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Success Modal -->
    <div id="report-success-modal" class="modal">
        <div class="modal-content success-modal-content">
            <div class="modal-header success-header">
                <h3><i class="fas fa-check-circle"></i> Report Submitted!</h3>
            </div>
            <div class="modal-body">
                <div class="ticket-info">
                    <p>Your issue has been reported successfully.</p>
                    <div class="ticket-id-display">
                        <label>Ticket ID:</label>
                        <span id="ticket-id-value">-</span>
                    </div>
                    <p class="ticket-note">
                        The gym will review your report and respond shortly. 
                        You can track your ticket status in your profile.
                    </p>
                </div>
                <button id="report-success-ok-btn" class="btn-primary">OK</button>
            </div>
        </div>
    </div>

    <!-- Include shared functionality from script.js for navbar and auth -->
    <script>
        // Shared functionality needed for navbar and authentication
        
        function logout() {
            localStorage.removeItem('token');
            window.location.href = 'index.html';
        }
        
        // User authentication check
        document.addEventListener("DOMContentLoaded", () => {
            const token = localStorage.getItem("token");
            const userNav = document.getElementById("user-profile-nav");
            const loginNav = document.getElementById("login-signup-nav");

            // Default states
            if (userNav) userNav.style.display = "none";
            if (loginNav) loginNav.style.display = "none";

            if (!token) {
                if (loginNav) loginNav.style.display = "block";
                return;
            }

            // Try to fetch user profile if token exists
            fetch(`${window.API_CONFIG.BASE_URL}/api/users/profile`, {
                method: 'GET',
                headers: {
                    'Content-Type': "application/json",
                    'Authorization': `Bearer ${token}`
                }
            })
            .then(async (res) => {
                if (!res.ok) {
                    const errText = await res.text();
                    throw new Error(`Server responded with ${res.status}: ${errText}`);
                }
                return res.json();
            })
            .then(user => {
                let profilePicUrl;
                if (user.profileImage) {
                    if (user.profileImage.startsWith('http')) {
                        profilePicUrl = user.profileImage;
                    } else {
                        profilePicUrl = `${window.API_CONFIG.BASE_URL}/${user.profileImage}`;
                    }
                } else {
                    profilePicUrl = `${window.API_CONFIG.BASE_URL}/uploads/profile-pics/default.png`;
                }

                const userIconImage = document.getElementById("profile-icon-img");
                if (userIconImage) userIconImage.src = profilePicUrl;

                if (userNav) userNav.style.display = "block";
                if (loginNav) loginNav.style.display = "none";
            })
            .catch(error => {
                console.error("Error fetching user:", error.message);
                if (loginNav) loginNav.style.display = "block";
            });
        });
        
        // Mobile menu toggle
        document.addEventListener('DOMContentLoaded', function () {
            const menuToggle = document.querySelector('.menu-toggle');
            const navLinks = document.querySelector('.nav-links');

            if (menuToggle && navLinks) {
                menuToggle.addEventListener('click', function () {
                    navLinks.classList.toggle('nav-active');
                });
            }

            // Dropdown handling for mobile
            document.querySelectorAll('.dropdown > a').forEach(function(dropLink) {
                dropLink.addEventListener('click', function(e) {
                    if (window.innerWidth <= 900) {
                        e.preventDefault();
                        const dropdown = this.parentElement;
                        dropdown.classList.toggle('dropdown-active');
                    }
                });
            });

            // Settings submenu handling for mobile
            document.querySelectorAll('.settings-option > a').forEach(function(settingsLink) {
                settingsLink.addEventListener('click', function(e) {
                    if (window.innerWidth <= 900) {
                        e.preventDefault();
                        const settingsOption = this.parentElement;
                        settingsOption.classList.toggle('settings-active');
                    }
                });
            });
            
            // Touch device support for settings dropdown
            const settingsOptions = document.querySelectorAll('.settings-option');
            
            settingsOptions.forEach(option => {
                // For mouse users
                option.addEventListener('mouseenter', function() {
                    this.querySelector('.settings-submenu').style.display = 'block';
                });
                
                option.addEventListener('mouseleave', function() {
                    this.querySelector('.settings-submenu').style.display = 'none';
                });
                
                // For touch devices
                option.addEventListener('click', function(e) {
                    if (window.innerWidth <= 900) {
                        e.preventDefault();
                        const submenu = this.querySelector('.settings-submenu');
                        submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';
                    }
                });
            });
        });
    </script>
    
    <!-- Gym Offers Integration - Now handles everything including hero button -->
    <!-- gymdetails-offers.js is the primary offers system -->
    <!-- gymdetails-hero-offers.js is DISABLED to prevent conflicts -->
    <!-- <script src="gymdetails-hero-offers.js"></script> -->
</body>
</html>
